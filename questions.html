<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Questions</title>
  </head>
  <body>
    <script>
      ////////////////////////////////

      function Person() {
        this.call = () => console.log(this); // здесь метод значит this указывает на
        this.call2 = function() {
          console.log(this);
        };
      }
      var person1 = new Person();
      console.log(person1.call());
      console.log(person1.call2());

      var person2 = {
        name: 'pesonParent',
        call: () => console.log(this), // здесь объявленеи стрелочной функции значит this указывает всегда на window ??
        call2: function() {
          console.log(this);
        },
        personChild: {
          name: 'personChild',
          call: () => this,
          call2: function() {
            return {
              arrowFunction: () => this
            };
          }
        }
      };
      console.log(person2.call());
      console.log(person2.call2());
      console.log('child', person2.personChild.call());
      console.log(person2.personChild.call2().arrowFunction().name);

      //////////////////////////

      function a(x) {
        return x * 2;
      }
      var a;

      console.log(a); /// функция приоритетнее чем вар, поэтому выведется тело функции

      //////////////////////

      // Где здесь замыкание?
      var w = 'w';
      // cтек переменных: w, Parent
      // LexicalEnvironmentWindow: null
      function Parent() {
        // cтек переменных функции: b, Child
        /// LexicalEnvironmentParent: b, Child, w
        // замыкание - w
        var b = 'b';
        function Child(name) {
          // cтек переменных функции: x, name
          /// LexicalEnvironmentChild: x, name, b, w
          // замыкание здесь - b, w, Parent
          var x = 'x';
        }
        Child();
      }
      Parent();
      // вызов Parent для нее создается специальный объект LexicalEnvironment
      // и в нее вкладываются все переменные которые находятся на одном уровне с ней и уровнем выше

      ////////////////////

      for (var i = 0; i < 10; i++) {
        setTimeout(() => {
          console.log(i);
        }, 0);
      }

      // решение1
      for (let i = 0; i < 10; i++) {
        setTimeout(() => {
          console.log(i);
        }, 0);
      }

      // решение2
      function print(val) {
        setTimeout(() => {
          console.log(val); // благодаря замыканию val будет равен аргументу которую получит функция
        }, 0);
      }

      for (var i = 0; i < 10; i++) {
        print(i);
      }

      /////
      // Можно ли сказть что функция fn через 2 секунды попадет в очередь событий?
      // и если основной поток будет выполнятся 12 секунд то функция fn() запустится
      // через 10 секунд после попадания в очередь
      // и если ajax запрсо выполнистя чез 1 секнуду то он первее fn() попадет в очередь?

      function fn() {
        console.log('fn');
      }
      setTimeout(fn, 2000);

      // resolve это что вроде return того что функция-колбэк которая после then получит в качестве авходного параметра?
      const promise = new Promise(function(resolve, reject) {
        resolve('oktq');
        reject(new Error('noooo'));
      });

      // здесь код перывается и ждет пока разрешится промис или он также выведет
      // его из потока в web api?
      promise
        .then(function(data) {
          return data;
        })
        .then(date => console.log(date))
        .catch(function(err) {
          console.log(err);
        });

      console.log('1');

      ////
      /// получается что здесь на 130 стрчоке код ждет выполнения а все остальное ниже не выполняется
      // косноль лог тоже будет ждать пока выполнится await req??
      async function x() {
        const res = await req;
        return res;
      }

      console.log('0');

      // fetch выкидывается из потока в Web Api ?
      // promise выкидывается из потока в Web Api?
      // async await
      // какие же server requests являются request api

      /// почеу когда мы используем fetch
      // fetch('').then(res => res.json()).then(data => echo(data))
      // res приходит промимсом и что делает json()


      for( const v of [1,2,3]) {
        console.log(v);
      }

      for(const i=0; i< 10; i++){
        /// не работает
      }

    </script>
  </body>
</html>
